"use strict";exports.id=9616,exports.ids=[9616],exports.modules={9616:(e,s,t)=>{t.d(s,{h:()=>b});var a=t(10326),n=t(17577),r=t(90772),l=t(28758),i=t(6070),d=t(62288),c=t(87673),m=t(33071),o=t(15940),u=t(10036),p=t(40035),x=t(5857),h=t(28834),j=t(43022),f=t(79611),g=t(31798),N=t(20278),y=t(96738),w=t(94215);let b=({requests:e,onApprove:s,onReject:t,onSignOut:b,onSignIn:v,onSendComment:_,onViewDetails:q})=>{let{toast:C}=(0,w.pm)(),z=(e,s)=>`${(e||"").charAt(0)}${(s||"").charAt(0)}`.toUpperCase(),[R,k]=(0,n.useState)({isOpen:!1,type:null,requestId:null,comment:"",request:null,isLoading:!1}),Z=(s,t)=>{let a=e.find(e=>e.id===t);k({isOpen:!0,type:s,requestId:t,comment:"",request:a||null,isLoading:!1})},S=async()=>{if(R.requestId&&R.type){k(e=>({...e,isLoading:!0}));try{if("approve"===R.type)await s(R.requestId,R.comment||void 0),C({title:"Success",description:"Exeat request approved successfully."});else if("reject"===R.type)await t(R.requestId,R.comment||void 0),C({title:"Success",description:"Exeat request rejected successfully."});else if("see_me"===R.type&&_)try{await _(R.requestId,R.comment),C({title:"Success",description:"Comment sent to student successfully."})}catch(s){console.error("Error sending comment:",s);let e="Failed to send comment. Please try again.";throw s.message&&(e=s.message),C({title:"Error",description:e,variant:"destructive"}),s}k({isOpen:!1,type:null,requestId:null,comment:"",request:null,isLoading:!1})}catch(e){console.error("Error processing action:",e),C({title:"Error",description:`Failed to ${"see_me"===R.type?"send comment":R.type} request. Please try again.`,variant:"destructive"}),k(e=>({...e,isLoading:!1}))}}};return(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"lg:hidden space-y-3",children:e.map(e=>{let s=e.student.passport?`data:image/jpeg;base64,${e.student.passport}`:"",t=(e.preferred_mode_of_contact||"").toLowerCase(),n="email"===t?e.parent_email:e.parent_phone_no||e.parent_phone_no_two;return(0,a.jsxs)(m.Zb,{className:"p-4 hover:shadow-md transition-shadow duration-200",children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,a.jsxs)(l.qE,{className:"h-10 w-10 flex-shrink-0",children:[a.jsx(l.F$,{src:s,alt:`${e.student.fname} ${e.student.lname}`}),a.jsx(l.Q5,{className:"text-xs",children:z(e.student.fname,e.student.lname)})]}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsxs)("h3",{className:"font-semibold text-base truncate",children:[e.student.fname," ",e.student.lname]}),a.jsx("p",{className:"text-sm text-muted-foreground font-mono truncate",children:e.matric_no})]})]}),a.jsx("div",{className:"mt-2",children:a.jsx(i.t,{status:e.status,size:"sm"})})]}),"security_signin"===e.status&&e.departure_date&&e.return_date&&a.jsx("div",{className:"mb-3",children:a.jsx(N.Y,{departureDate:e.departure_date,returnDate:e.return_date,variant:"staff",className:"w-full"})}),a.jsx("div",{className:"mb-3",children:(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 px-2.5 py-1 rounded-full bg-slate-100 text-slate-700",children:["email"===t?a.jsx(u.Z,{className:"h-3.5 w-3.5"}):a.jsx(p.Z,{className:"h-3.5 w-3.5"}),a.jsx("span",{className:"text-xs font-medium",children:"whatsapp"===t?"WhatsApp":"text"===t?"Text":"phone_call"===t?"Phone":"email"===t?"Email":"Contact"}),n&&a.jsx("span",{className:"text-xs font-mono truncate max-w-[140px]",children:n})]})}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(r.z,{size:"sm",className:"flex-1 min-w-[100px] bg-green-600 hover:bg-green-700 text-white disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z("approve",e.id),disabled:["rejected","completed"].includes(e.status),children:[a.jsx(x.Z,{className:"h-4 w-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"truncate",children:(0,y.Q4)(e.status)})]}),!["hostel_signout","hostel_signin","security_signout","security_signin","completed","rejected"].includes(e.status)&&(0,a.jsxs)(r.z,{variant:"destructive",size:"sm",className:"flex-1 min-w-[100px]",onClick:()=>Z("reject",e.id),children:[a.jsx(h.Z,{className:"h-4 w-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"truncate",children:"Reject"})]})]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(r.z,{variant:"outline",size:"sm",className:"flex-1 min-w-[100px]",onClick:()=>q(e),children:[a.jsx(j.Z,{className:"h-4 w-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"truncate",children:"Details"})]}),!!_&&(0,a.jsxs)(r.z,{variant:"outline",size:"sm",className:"flex-1 min-w-[100px] disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z("see_me",e.id),disabled:["hostel_signout","hostel_signin","security_signout","security_signin","completed"].includes(e.status),children:[a.jsx(f.Z,{className:"h-4 w-4 mr-1 sm:mr-2"}),a.jsx("span",{className:"truncate",children:"See Me"})]})]})]})]},e.id)})}),a.jsx("div",{className:"hidden lg:block rounded-lg border bg-background",children:(0,a.jsxs)(o.iA,{className:"text-[15px] md:text-base",children:[a.jsx(o.xD,{className:"sticky top-0 z-10 bg-background",children:(0,a.jsxs)(o.SC,{className:"bg-muted/50",children:[a.jsx(o.ss,{className:"whitespace-nowrap text-sm md:text-base",children:"Student"}),a.jsx(o.ss,{className:"whitespace-nowrap text-sm md:text-base",children:"Status"}),a.jsx(o.ss,{className:"text-right whitespace-nowrap text-sm md:text-base",children:"Actions"})]})}),a.jsx(o.RM,{children:e.map(e=>{let s=e.student.passport?`data:image/jpeg;base64,${e.student.passport}`:"",t=(e.preferred_mode_of_contact||"").toLowerCase(),n="email"===t?e.parent_email:e.parent_phone_no||e.parent_phone_no_two;return(0,a.jsxs)(o.SC,{className:"align-middle",children:[a.jsx(o.pj,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(l.qE,{className:"size-10",children:[a.jsx(l.F$,{src:s,alt:`${e.student.fname} ${e.student.lname}`}),a.jsx(l.Q5,{className:"text-xs",children:z(e.student.fname,e.student.lname)})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("span",{className:"font-medium",children:[e.student.fname," ",e.student.lname]}),a.jsx("span",{className:"text-muted-foreground font-mono text-xs",children:e.matric_no}),a.jsx("div",{className:"mt-1 inline-flex items-center gap-2 max-w-full",children:(0,a.jsxs)("div",{className:"inline-flex items-center gap-1.5 px-2 py-0.5 rounded-full bg-slate-100 text-slate-700",children:["email"===t?a.jsx(u.Z,{className:"h-3.5 w-3.5"}):a.jsx(p.Z,{className:"h-3.5 w-3.5"}),a.jsx("span",{className:"text-[11px] font-medium",children:"whatsapp"===t?"WhatsApp":"text"===t?"Text":"phone_call"===t?"Phone":"email"===t?"Email":"Contact"}),n&&a.jsx("span",{className:"text-[11px] font-mono truncate max-w-[180px]",children:n})]})}),"security_signout"===e.status&&e.departure_date&&e.return_date&&a.jsx("div",{className:"mt-2 max-w-full",children:a.jsx(N.Y,{departureDate:e.departure_date,returnDate:e.return_date,variant:"staff",className:"w-full max-w-md"})})]})]})}),a.jsx(o.pj,{children:a.jsx(i.t,{status:e.status,size:"sm"})}),a.jsx(o.pj,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex flex-wrap justify-end gap-2",children:[(0,a.jsxs)(r.z,{size:"sm",className:"h-8 px-3 text-[13px] md:text-sm bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z("approve",e.id),disabled:["rejected","completed"].includes(e.status),children:[a.jsx(x.Z,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:(0,y.Q4)(e.status)})]}),!["hostel_signout","hostel_signin","security_signout","security_signin","completed","rejected"].includes(e.status)&&(0,a.jsxs)(r.z,{variant:"destructive",size:"sm",className:"h-8 px-3 text-[13px] md:text-sm",onClick:()=>Z("reject",e.id),children:[a.jsx(h.Z,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Reject"})]}),!!_&&(0,a.jsxs)(r.z,{variant:"outline",size:"sm",className:"h-8 px-3 text-[13px] md:text-sm disabled:opacity-50 disabled:cursor-not-allowed",onClick:()=>Z("see_me",e.id),disabled:["hostel_signout","hostel_signin","security_signout","security_signin","completed"].includes(e.status),children:[a.jsx(f.Z,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"See Me"})]}),(0,a.jsxs)(r.z,{variant:"outline",size:"sm",className:"h-8 px-3 text-[13px] md:text-sm",onClick:()=>q(e),children:[a.jsx(j.Z,{className:"h-4 w-4 mr-2"}),a.jsx("span",{className:"hidden sm:inline",children:"Details"})]})]})})]},e.id)})})]})}),a.jsx(d.Vq,{open:R.isOpen,onOpenChange:e=>k(s=>({...s,isOpen:e})),children:(0,a.jsxs)(d.cZ,{children:[(0,a.jsxs)(d.fK,{children:[a.jsx(d.$N,{children:"approve"===R.type?"Approve Exeat Request":"reject"===R.type?"Reject Exeat Request":"Send Comment to Student"}),a.jsx(d.Be,{children:R.request&&"approve"===R.type?(0,a.jsxs)(a.Fragment,{children:[(0,y.xE)(R.request.status,`${R.request.student.fname} ${R.request.student.lname}`,R.request.reason,R.request.destination,Math.ceil((new Date(R.request.return_date).getTime()-new Date(R.request.departure_date).getTime())/864e5)),a.jsx("br",{}),a.jsx("span",{className:"font-medium text-green-700",children:"This action cannot be undone."})]}):R.request&&"reject"===R.type?(0,a.jsxs)(a.Fragment,{children:[(0,y.G4)(R.request.status,`${R.request.student.fname} ${R.request.student.lname}`,R.request.reason,R.request.destination,Math.ceil((new Date(R.request.return_date).getTime()-new Date(R.request.departure_date).getTime())/864e5)),a.jsx("br",{}),a.jsx("span",{className:"font-medium text-red-700",children:"This action cannot be undone."})]}):R.request&&"see_me"===R.type?(0,a.jsxs)(a.Fragment,{children:["Send a message to ",R.request.student.fname," ",R.request.student.lname," requesting them to see you."]}):"approve"===R.type?"Are you sure you want to approve this exeat request? You can add an optional comment below.":"reject"===R.type?"Are you sure you want to reject this exeat request? Please provide a reason for rejection.":"Please provide a message for the student."})]}),a.jsx("div",{className:"space-y-4",children:(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"approve"===R.type?"Comment (Optional)":"reject"===R.type?"Reason for Rejection *":"Message for Student *"}),a.jsx(c.g,{placeholder:"approve"===R.type?"Add any additional notes or conditions...":"reject"===R.type?"Please provide a reason for rejection...":"Enter your message for the student...",value:R.comment,onChange:e=>k(s=>({...s,comment:e.target.value})),className:"mt-1",rows:3,defaultValue:"see_me"===R.type?"Come to my office to see me":"",required:"reject"===R.type||"see_me"===R.type})]})}),(0,a.jsxs)(d.cN,{children:[a.jsx(r.z,{variant:"outline",onClick:()=>k({isOpen:!1,type:null,requestId:null,comment:"",request:null,isLoading:!1}),disabled:R.isLoading,children:"Cancel"}),a.jsx(r.z,{onClick:S,className:"approve"===R.type?"bg-green-600 hover:bg-green-700":"reject"===R.type?"bg-red-600 hover:bg-red-700":"",disabled:R.isLoading||("reject"===R.type||"see_me"===R.type)&&!R.comment.trim(),children:R.isLoading?(0,a.jsxs)(a.Fragment,{children:[a.jsx(g.Z,{className:"h-4 w-4 mr-2 animate-spin"}),"Processing..."]}):"approve"===R.type?"Approve Request":"reject"===R.type?"Reject Request":"Send Comment"})]})]})})]})}},15940:(e,s,t)=>{t.d(s,{RM:()=>d,SC:()=>c,iA:()=>l,pj:()=>o,ss:()=>m,xD:()=>i});var a=t(10326),n=t(17577),r=t(77863);let l=n.forwardRef(({className:e,...s},t)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:t,className:(0,r.cn)("w-full caption-bottom text-sm",e),...s})}));l.displayName="Table";let i=n.forwardRef(({className:e,...s},t)=>a.jsx("thead",{ref:t,className:(0,r.cn)("[&_tr]:border-b",e),...s}));i.displayName="TableHeader";let d=n.forwardRef(({className:e,...s},t)=>a.jsx("tbody",{ref:t,className:(0,r.cn)("[&_tr:last-child]:border-0",e),...s}));d.displayName="TableBody",n.forwardRef(({className:e,...s},t)=>a.jsx("tfoot",{ref:t,className:(0,r.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";let c=n.forwardRef(({className:e,...s},t)=>a.jsx("tr",{ref:t,className:(0,r.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));c.displayName="TableRow";let m=n.forwardRef(({className:e,...s},t)=>a.jsx("th",{ref:t,className:(0,r.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));m.displayName="TableHead";let o=n.forwardRef(({className:e,...s},t)=>a.jsx("td",{ref:t,className:(0,r.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));o.displayName="TableCell",n.forwardRef(({className:e,...s},t)=>a.jsx("caption",{ref:t,className:(0,r.cn)("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption"},10036:(e,s,t)=>{t.d(s,{Z:()=>a});let a=(0,t(9664).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])}};