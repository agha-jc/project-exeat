(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[630],{25883:function(e,s,t){Promise.resolve().then(t.bind(t,52716))},52716:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Y}});var a=t(57437),l=t(2265),n=t(66070),r=t(62869),d=t(35974),i=t(95186),c=t(18025),o=t(74376),m=t(25361),x=t(24287),u=t(63390),h=t(12032),f=t(16049),p=t(23818),j=t(67350),N=t(13147),g=t(88880),b=t(46747),w=t(87928),v=t(98012),y=t(81475),_=t(25518),Z=t(91120),C=t(55672),k=t(5255),M=t(27107),O=t(99376),R=t(35153),S=t(33145),q=t(84190),D=t(37099);let U=[{value:"all",label:"All Statuses"},{value:"unpaid",label:"Unpaid"},{value:"paid",label:"Paid"},{value:"cleared",label:"Cleared"}];function Y(){var e,s;let[t,Y]=(0,l.useState)(""),[z,A]=(0,l.useState)("all"),[F,L]=(0,l.useState)(1),[T,P]=(0,l.useState)(15),[E,W]=(0,l.useState)(!1),[V,X]=(0,l.useState)(null),$=(0,O.useRouter)(),{data:G,isLoading:I,refetch:J}=(0,c.Kp)({payment_status:"all"===z?void 0:z,page:F,per_page:T}),[K]=(0,c.tU)(),Q=(null==G?void 0:null===(e=G.data)||void 0===e?void 0:e.data)||[],B=(null==G?void 0:null===(s=G.data)||void 0===s?void 0:s.total)||0,H=Q.filter(e=>{let s=t.toLowerCase();return""===t||e.student.fname.toLowerCase().includes(s)||e.student.lname.toLowerCase().includes(s)||e.exeat_request.matric_no.toLowerCase().includes(s)||e.amount.includes(s)||e.exeat_request.reason.toLowerCase().includes(s)||e.exeat_request.destination.toLowerCase().includes(s)||e.student.phone.includes(s)||e.student.email.toLowerCase().includes(s)||"".concat(e.student.fname," ").concat(e.student.lname).toLowerCase().includes(s)}),ee=Q.filter(e=>"unpaid"===e.payment_status).length,es=Q.filter(e=>"paid"===e.payment_status).length;Q.filter(e=>"cleared"===e.payment_status).length;let et=Q.reduce((e,s)=>e+parseFloat(s.amount),0),ea=Q.filter(e=>e.overdue_hours>0).length,el=Q.filter(e=>e.exeat_request.is_medical).length,en=e=>{switch(e){case"unpaid":return(0,a.jsx)(o.Z,{className:"h-4 w-4 text-red-600"});case"paid":return(0,a.jsx)(m.Z,{className:"h-4 w-4 text-yellow-600"});case"cleared":return(0,a.jsx)(x.Z,{className:"h-4 w-4 text-green-600"});default:return(0,a.jsx)(m.Z,{className:"h-4 w-4 text-gray-600"})}},er=e=>{switch(e){case"unpaid":return(0,a.jsx)(d.C,{variant:"destructive",children:"Unpaid"});case"paid":return(0,a.jsx)(d.C,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Paid"});case"cleared":return(0,a.jsx)(d.C,{variant:"default",className:"bg-green-100 text-green-800",children:"Cleared"});default:return(0,a.jsx)(d.C,{variant:"outline",children:"Unknown"})}},ed=e=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(parseFloat(e)),ei=e=>{X(e),W(!0)},ec=async()=>{if(V)try{await K({id:V,data:{notes:"Manually cleared by admin"}}).unwrap(),(0,R.Am)({title:"Success",description:"Debt cleared successfully."}),J()}catch(s){var e;(0,R.Am)({title:"Error",description:(null==s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||"Failed to clear debt.",variant:"destructive"})}finally{W(!1),X(null)}};return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold",children:"Student Debts"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Manage student exeat-related debts"})]}),(0,a.jsxs)("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6",children:[(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Debts"}),(0,a.jsx)(u.Z,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:B}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All debt records"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Unpaid"}),(0,a.jsx)(o.Z,{className:"h-4 w-4 text-red-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600",children:ee}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Require payment"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Paid"}),(0,a.jsx)(m.Z,{className:"h-4 w-4 text-yellow-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:es}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Pending verification"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Overdue"}),(0,a.jsx)(h.Z,{className:"h-4 w-4 text-orange-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:ea}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Past due date"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Medical"}),(0,a.jsx)(f.Z,{className:"h-4 w-4 text-blue-600"})]}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:el}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Medical exeats"})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:(0,a.jsx)(n.ll,{className:"text-sm font-medium",children:"Total Amount"})}),(0,a.jsxs)(n.aY,{children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:ed(et.toString())}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"All debts combined"})]})]})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsx)(n.Ol,{children:(0,a.jsxs)(n.ll,{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Z,{className:"h-5 w-5"}),"Search & Filter"]})}),(0,a.jsx)(n.aY,{children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,a.jsx)(i.I,{placeholder:"Search by name, matric, amount, reason, destination, phone, or email...",value:t,onChange:e=>Y(e.target.value),className:"pl-10"})]})}),(0,a.jsx)("div",{className:"w-full sm:w-48",children:(0,a.jsx)("select",{value:z,onChange:e=>A(e.target.value),className:"w-full px-3 py-2 border border-input bg-background rounded-md text-sm",children:U.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))})})]})})]}),(0,a.jsxs)(n.Zb,{children:[(0,a.jsxs)(n.Ol,{children:[(0,a.jsx)(n.ll,{children:"Debt Records"}),(0,a.jsxs)(n.SZ,{children:[H.length," of ",B," debt records"]})]}),(0,a.jsx)(n.aY,{children:I?(0,a.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0,void 0,void 0].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center gap-4 p-4 border rounded-lg animate-pulse",children:[(0,a.jsx)("div",{className:"h-12 w-12 bg-gray-200 rounded-full"}),(0,a.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]}),(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-16"})]},s))}):0===H.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(u.Z,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-semibold text-gray-900",children:"No debts found"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:t||"all"!==z?"Try adjusting your search or filters.":"No student debt records found."})]}):(0,a.jsx)("div",{className:"space-y-4",children:H.map(e=>(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-4 p-4 border rounded-lg hover:bg-accent/50 transition-colors",children:[(0,a.jsx)("div",{className:"h-16 w-16 rounded-full bg-primary/10 flex items-center justify-center flex-shrink-0 overflow-hidden",children:e.student.passport?(0,a.jsx)(S.default,{src:"data:image/jpeg;base64,".concat(e.student.passport),alt:"".concat(e.student.fname," ").concat(e.student.lname,"'s passport"),width:64,height:64,className:"h-full w-full object-contain",unoptimized:!0}):(0,a.jsx)(j.Z,{className:"h-8 w-8 text-primary"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 w-full lg:w-auto",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mb-2",children:[(0,a.jsxs)("h3",{className:"font-semibold text-lg",children:[e.student.fname," ",e.student.lname]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[en(e.payment_status),er(e.payment_status)]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 text-sm text-muted-foreground mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(j.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:e.exeat_request.matric_no})]}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("span",{className:"font-medium text-green-600",children:ed(e.amount)})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:[(0,M.WU)(new Date(e.exeat_request.departure_date),"MMM d")," - ",(0,M.WU)(new Date(e.exeat_request.return_date),"MMM d, yyyy")]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-muted-foreground mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.student.phone})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"break-all",children:e.student.email})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm text-muted-foreground mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:e.exeat_request.reason})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:e.exeat_request.destination})]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-4 text-xs text-muted-foreground",children:[e.overdue_hours>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-red-600",children:[(0,a.jsx)(y.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:[e.overdue_hours,"h overdue"]})]}),e.exeat_request.is_medical&&(0,a.jsxs)("div",{className:"flex items-center gap-1 text-blue-600",children:[(0,a.jsx)(f.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:"Medical"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(_.Z,{className:"h-3 w-3"}),(0,a.jsxs)("span",{children:["Created: ",(0,M.WU)(new Date(e.created_at),"MMM d, yyyy")]})]}),e.exeat_request.student_accommodation&&(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)(Z.Z,{className:"h-3 w-3"}),(0,a.jsx)("span",{children:e.exeat_request.student_accommodation})]})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0 w-full lg:w-auto",children:(0,a.jsxs)(q.h_,{children:[(0,a.jsx)(q.$F,{asChild:!0,children:(0,a.jsx)(r.z,{variant:"ghost",size:"icon",className:"w-full lg:w-auto",children:(0,a.jsx)(C.Z,{className:"h-4 w-4"})})}),(0,a.jsxs)(q.AW,{align:"end",children:[(0,a.jsxs)(q.Xi,{onClick:()=>$.push("/staff/admin/student-debts/".concat(e.id)),children:[(0,a.jsx)(w.Z,{className:"mr-2 h-4 w-4"}),"View Details"]}),"cleared"!==e.payment_status&&(0,a.jsxs)(q.Xi,{onClick:()=>ei(e.id),className:"text-green-600",children:[(0,a.jsx)(k.Z,{className:"mr-2 h-4 w-4"}),"Clear Debt"]})]})]})})]},e.id))})})]}),(0,a.jsx)(D.aR,{open:E,onOpenChange:W,children:(0,a.jsxs)(D._T,{children:[(0,a.jsxs)(D.fY,{children:[(0,a.jsx)(D.f$,{children:"Clear Student Debt"}),(0,a.jsx)(D.yT,{children:"Are you sure you want to manually clear this student's debt? This action will mark the debt as cleared and cannot be undone."})]}),(0,a.jsxs)(D.xo,{children:[(0,a.jsx)(D.le,{children:"Cancel"}),(0,a.jsx)(D.OL,{onClick:ec,className:"bg-green-600 text-white hover:bg-green-700",children:"Clear Debt"})]})]})})]})}},84190:function(e,s,t){"use strict";t.d(s,{$F:function(){return m},AW:function(){return u},Ju:function(){return f},Qk:function(){return x},VD:function(){return p},Xi:function(){return h},h_:function(){return o}});var a=t(57437),l=t(2265),n=t(12465),r=t(76848),d=t(59559),i=t(78084),c=t(94508);let o=n.fC,m=n.xz,x=n.ZA;n.Uv,n.Tr,n.Ee,l.forwardRef((e,s)=>{let{className:t,inset:l,children:d,...i}=e;return(0,a.jsxs)(n.fF,{ref:s,className:(0,c.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",l&&"pl-8",t),...i,children:[d,(0,a.jsx)(r.Z,{className:"ml-auto h-4 w-4"})]})}).displayName=n.fF.displayName,l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.tu,{ref:s,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})}).displayName=n.tu.displayName;let u=l.forwardRef((e,s)=>{let{className:t,sideOffset:l=4,...r}=e;return(0,a.jsx)(n.Uv,{children:(0,a.jsx)(n.VY,{ref:s,sideOffset:l,className:(0,c.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})});u.displayName=n.VY.displayName;let h=l.forwardRef((e,s)=>{let{className:t,inset:l,...r}=e;return(0,a.jsx)(n.ck,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",l&&"pl-8",t),...r})});h.displayName=n.ck.displayName,l.forwardRef((e,s)=>{let{className:t,children:l,checked:r,...i}=e;return(0,a.jsxs)(n.oC,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(d.Z,{className:"h-4 w-4"})})}),l]})}).displayName=n.oC.displayName,l.forwardRef((e,s)=>{let{className:t,children:l,...r}=e;return(0,a.jsxs)(n.Rk,{ref:s,className:(0,c.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(n.wU,{children:(0,a.jsx)(i.Z,{className:"h-2 w-2 fill-current"})})}),l]})}).displayName=n.Rk.displayName;let f=l.forwardRef((e,s)=>{let{className:t,inset:l,...r}=e;return(0,a.jsx)(n.__,{ref:s,className:(0,c.cn)("px-2 py-1.5 text-sm font-semibold",l&&"pl-8",t),...r})});f.displayName=n.__.displayName;let p=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.Z0,{ref:s,className:(0,c.cn)("-mx-1 my-1 h-px bg-muted",t),...l})});p.displayName=n.Z0.displayName}},function(e){e.O(0,[2915,3557,9946,5844,9049,2061,9923,3145,1,5359,6300,4879,2971,2117,1744],function(){return e(e.s=25883)}),_N_E=e.O()}]);